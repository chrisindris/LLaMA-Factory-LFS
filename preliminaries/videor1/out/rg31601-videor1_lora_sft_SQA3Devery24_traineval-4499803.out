WARNING: Skipping /dev/shm bind mount: already mounted

==========
== CUDA ==
==========

CUDA Version 12.4.1

Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.

[INFO|2025-12-21 07:58:40] llamafactory.launcher:143 >> Initializing 4 distributed tasks at: 127.0.0.1:41017
W1221 07:58:41.243000 166 site-packages/torch/distributed/run.py:792] 
W1221 07:58:41.243000 166 site-packages/torch/distributed/run.py:792] *****************************************
W1221 07:58:41.243000 166 site-packages/torch/distributed/run.py:792] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1221 07:58:41.243000 166 site-packages/torch/distributed/run.py:792] *****************************************
[DEBUG template.py] Starting videor1 template registration at line 2117[DEBUG template.py] Starting videor1 template registration at line 2117

[DEBUG template.py] Current templates before videor1 registration: ['alpaca', 'aquila', 'atom', 'baichuan', 'baichuan2', 'bailing', 'bailing_v2', 'belle', 'bluelm', 'breeze']...[DEBUG template.py] Current templates before videor1 registration: ['alpaca', 'aquila', 'atom', 'baichuan', 'baichuan2', 'bailing', 'bailing_v2', 'belle', 'bluelm', 'breeze']...

[DEBUG template.py] Attempting to get videor1 plugin...[DEBUG template.py] Attempting to get videor1 plugin...

[DEBUG template.py] Successfully got videor1 plugin: <class 'llamafactory.data.mm_plugin.Videor1Plugin'>[DEBUG template.py] Successfully got videor1 plugin: <class 'llamafactory.data.mm_plugin.Videor1Plugin'>

[DEBUG template.py] About to call register_template for videor1...[DEBUG template.py] About to call register_template for videor1...

[DEBUG template.py] Successfully registered videor1 template[DEBUG template.py] Successfully registered videor1 template

[DEBUG template.py] Templates after videor1 registration: ['alpaca', 'aquila', 'atom', 'baichuan', 'baichuan2', 'bailing', 'bailing_v2', 'belle', 'bluelm', 'breeze', 'chatglm2', 'chatglm3', 'chatml', 'chatml_de', 'codegeex2']...[DEBUG template.py] Templates after videor1 registration: ['alpaca', 'aquila', 'atom', 'baichuan', 'baichuan2', 'bailing', 'bailing_v2', 'belle', 'bluelm', 'breeze', 'chatglm2', 'chatglm3', 'chatml', 'chatml_de', 'codegeex2']...

[DEBUG template.py] videor1 in TEMPLATES: True[DEBUG template.py] videor1 in TEMPLATES: True

[DEBUG template.py] Module template.py loaded completely. Total templates registered: 120[DEBUG template.py] Module template.py loaded completely. Total templates registered: 120

[DEBUG template.py] videor1 template registered: True[DEBUG template.py] videor1 template registered: True

[DEBUG template.py] videor1 template details: Template(format_user=StringFormatter(slots=['<|im_start|>user\n{{content}}<|im_end|>\n<|im_start|>assistant\n'], tool_format=None), format_assistant=StringFormatter(slots=['{{content}}<|im_end|>\n'], tool_format=None), format_system=StringFormatter(slots=['<|im_start|>system\n{{content}}<|im_end|>\n'], tool_format=None), format_function=FunctionFormatter(slots=['{{content}}<|im_end|>\n'], tool_format='qwen'), format_observation=StringFormatter(slots=['<|im_start|>user\n<tool_response>\n{{content}}\n</tool_response><|im_end|>\n<|im_start|>assistant\n'], tool_format=None), format_tools=ToolFormatter(slots=[], tool_format='qwen'), format_prefix=EmptyFormatter(slots=[], tool_format=None), default_system='You are a helpful assistant.', stop_words=['<|im_end|>'], thought_words=('<think>\n', '\n</think>\n\n'), efficient_eos=False, replace_eos=True, replace_jinja_template=False, enable_thinking=True, mm_plugin=Videor1Plugin(image_token='<|image_pad|>', video_token='<|video_pad|>', audio_token=None, expand_mm_tokens=True, vision_bos_token='<|vision_start|>', vision_eos_token='<|vision_end|>'))[DEBUG template.py] videor1 template details: Template(format_user=StringFormatter(slots=['<|im_start|>user\n{{content}}<|im_end|>\n<|im_start|>assistant\n'], tool_format=None), format_assistant=StringFormatter(slots=['{{content}}<|im_end|>\n'], tool_format=None), format_system=StringFormatter(slots=['<|im_start|>system\n{{content}}<|im_end|>\n'], tool_format=None), format_function=FunctionFormatter(slots=['{{content}}<|im_end|>\n'], tool_format='qwen'), format_observation=StringFormatter(slots=['<|im_start|>user\n<tool_response>\n{{content}}\n</tool_response><|im_end|>\n<|im_start|>assistant\n'], tool_format=None), format_tools=ToolFormatter(slots=[], tool_format='qwen'), format_prefix=EmptyFormatter(slots=[], tool_format=None), default_system='You are a helpful assistant.', stop_words=['<|im_end|>'], thought_words=('<think>\n', '\n</think>\n\n'), efficient_eos=False, replace_eos=True, replace_jinja_template=False, enable_thinking=True, mm_plugin=Videor1Plugin(image_token='<|image_pad|>', video_token='<|video_pad|>', audio_token=None, expand_mm_tokens=True, vision_bos_token='<|vision_start|>', vision_eos_token='<|vision_end|>'))

[DEBUG template.py] Starting videor1 template registration at line 2117
[DEBUG template.py] Current templates before videor1 registration: ['alpaca', 'aquila', 'atom', 'baichuan', 'baichuan2', 'bailing', 'bailing_v2', 'belle', 'bluelm', 'breeze']...
[DEBUG template.py] Attempting to get videor1 plugin...
[DEBUG template.py] Successfully got videor1 plugin: <class 'llamafactory.data.mm_plugin.Videor1Plugin'>
[DEBUG template.py] About to call register_template for videor1...
[DEBUG template.py] Successfully registered videor1 template
[DEBUG template.py] Templates after videor1 registration: ['alpaca', 'aquila', 'atom', 'baichuan', 'baichuan2', 'bailing', 'bailing_v2', 'belle', 'bluelm', 'breeze', 'chatglm2', 'chatglm3', 'chatml', 'chatml_de', 'codegeex2']...
[DEBUG template.py] videor1 in TEMPLATES: True
[DEBUG template.py] Module template.py loaded completely. Total templates registered: 120
[DEBUG template.py] videor1 template registered: True
[DEBUG template.py] videor1 template details: Template(format_user=StringFormatter(slots=['<|im_start|>user\n{{content}}<|im_end|>\n<|im_start|>assistant\n'], tool_format=None), format_assistant=StringFormatter(slots=['{{content}}<|im_end|>\n'], tool_format=None), format_system=StringFormatter(slots=['<|im_start|>system\n{{content}}<|im_end|>\n'], tool_format=None), format_function=FunctionFormatter(slots=['{{content}}<|im_end|>\n'], tool_format='qwen'), format_observation=StringFormatter(slots=['<|im_start|>user\n<tool_response>\n{{content}}\n</tool_response><|im_end|>\n<|im_start|>assistant\n'], tool_format=None), format_tools=ToolFormatter(slots=[], tool_format='qwen'), format_prefix=EmptyFormatter(slots=[], tool_format=None), default_system='You are a helpful assistant.', stop_words=['<|im_end|>'], thought_words=('<think>\n', '\n</think>\n\n'), efficient_eos=False, replace_eos=True, replace_jinja_template=False, enable_thinking=True, mm_plugin=Videor1Plugin(image_token='<|image_pad|>', video_token='<|video_pad|>', audio_token=None, expand_mm_tokens=True, vision_bos_token='<|vision_start|>', vision_eos_token='<|vision_end|>'))
[DEBUG template.py] Starting videor1 template registration at line 2117
[DEBUG template.py] Current templates before videor1 registration: ['alpaca', 'aquila', 'atom', 'baichuan', 'baichuan2', 'bailing', 'bailing_v2', 'belle', 'bluelm', 'breeze']...
[DEBUG template.py] Attempting to get videor1 plugin...
[DEBUG template.py] Successfully got videor1 plugin: <class 'llamafactory.data.mm_plugin.Videor1Plugin'>
[DEBUG template.py] About to call register_template for videor1...
[DEBUG template.py] Successfully registered videor1 template
[DEBUG template.py] Templates after videor1 registration: ['alpaca', 'aquila', 'atom', 'baichuan', 'baichuan2', 'bailing', 'bailing_v2', 'belle', 'bluelm', 'breeze', 'chatglm2', 'chatglm3', 'chatml', 'chatml_de', 'codegeex2']...
[DEBUG template.py] videor1 in TEMPLATES: True
[DEBUG template.py] Module template.py loaded completely. Total templates registered: 120
[DEBUG template.py] videor1 template registered: True
[DEBUG template.py] videor1 template details: Template(format_user=StringFormatter(slots=['<|im_start|>user\n{{content}}<|im_end|>\n<|im_start|>assistant\n'], tool_format=None), format_assistant=StringFormatter(slots=['{{content}}<|im_end|>\n'], tool_format=None), format_system=StringFormatter(slots=['<|im_start|>system\n{{content}}<|im_end|>\n'], tool_format=None), format_function=FunctionFormatter(slots=['{{content}}<|im_end|>\n'], tool_format='qwen'), format_observation=StringFormatter(slots=['<|im_start|>user\n<tool_response>\n{{content}}\n</tool_response><|im_end|>\n<|im_start|>assistant\n'], tool_format=None), format_tools=ToolFormatter(slots=[], tool_format='qwen'), format_prefix=EmptyFormatter(slots=[], tool_format=None), default_system='You are a helpful assistant.', stop_words=['<|im_end|>'], thought_words=('<think>\n', '\n</think>\n\n'), efficient_eos=False, replace_eos=True, replace_jinja_template=False, enable_thinking=True, mm_plugin=Videor1Plugin(image_token='<|image_pad|>', video_token='<|video_pad|>', audio_token=None, expand_mm_tokens=True, vision_bos_token='<|vision_start|>', vision_eos_token='<|vision_end|>'))
⚙️  Running in WANDB offline mode⚙️  Running in WANDB offline mode⚙️  Running in WANDB offline mode⚙️  Running in WANDB offline mode



[2025-12-21 07:58:50,736] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-12-21 07:58:50,736] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-12-21 07:58:50,736] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-12-21 07:58:50,736] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/opt/conda/lib/python3.11/site-packages/jieba/_compat.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/opt/conda/lib/python3.11/site-packages/jieba/_compat.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/opt/conda/lib/python3.11/site-packages/jieba/_compat.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
/opt/conda/lib/python3.11/site-packages/jieba/_compat.py:18: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  import pkg_resources
[2025-12-21 07:58:54,992] [INFO] [comm.py:669:init_distributed] cdb=None
[2025-12-21 07:58:54,992] [INFO] [comm.py:700:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2025-12-21 07:58:54,994] [INFO] [comm.py:669:init_distributed] cdb=None
[2025-12-21 07:58:54,999] [INFO] [comm.py:669:init_distributed] cdb=None
[2025-12-21 07:58:55,002] [INFO] [comm.py:669:init_distributed] cdb=None
[INFO|2025-12-21 07:58:55] llamafactory.hparams.parser:143 >> Set `ddp_find_unused_parameters` to False in DDP training since LoRA is enabled.
[INFO|2025-12-21 07:58:55] llamafactory.hparams.parser:455 >> Process rank: 0, world size: 4, device: cuda:0, distributed training: True, compute dtype: torch.bfloat16
[INFO|hub.py:421] 2025-12-21 07:58:55,559 >> Offline mode: forcing local_files_only=True
[INFO|tokenization_utils_base.py:1949] 2025-12-21 07:58:55,569 >> Offline mode: forcing local_files_only=True
[INFO|tokenization_utils_base.py:2095] 2025-12-21 07:58:55,573 >> loading file vocab.json from cache at /scratch/indrisch/huggingface/hub/models--Video-R1--Video-R1-7B/snapshots/e6840e4cdc86b484b05aacdcb5c88ad3d7ef3d76/vocab.json
[INFO|tokenization_utils_base.py:2095] 2025-12-21 07:58:55,574 >> loading file merges.txt from cache at /scratch/indrisch/huggingface/hub/models--Video-R1--Video-R1-7B/snapshots/e6840e4cdc86b484b05aacdcb5c88ad3d7ef3d76/merges.txt
[INFO|tokenization_utils_base.py:2095] 2025-12-21 07:58:55,574 >> loading file tokenizer.json from cache at /scratch/indrisch/huggingface/hub/models--Video-R1--Video-R1-7B/snapshots/e6840e4cdc86b484b05aacdcb5c88ad3d7ef3d76/tokenizer.json
[INFO|tokenization_utils_base.py:2095] 2025-12-21 07:58:55,574 >> loading file added_tokens.json from cache at /scratch/indrisch/huggingface/hub/models--Video-R1--Video-R1-7B/snapshots/e6840e4cdc86b484b05aacdcb5c88ad3d7ef3d76/added_tokens.json
[INFO|tokenization_utils_base.py:2095] 2025-12-21 07:58:55,574 >> loading file special_tokens_map.json from cache at /scratch/indrisch/huggingface/hub/models--Video-R1--Video-R1-7B/snapshots/e6840e4cdc86b484b05aacdcb5c88ad3d7ef3d76/special_tokens_map.json
[INFO|tokenization_utils_base.py:2095] 2025-12-21 07:58:55,574 >> loading file tokenizer_config.json from cache at /scratch/indrisch/huggingface/hub/models--Video-R1--Video-R1-7B/snapshots/e6840e4cdc86b484b05aacdcb5c88ad3d7ef3d76/tokenizer_config.json
[INFO|tokenization_utils_base.py:2095] 2025-12-21 07:58:55,574 >> loading file chat_template.jinja from cache at None
[INFO|tokenization_utils_base.py:2364] 2025-12-21 07:58:55,880 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|hub.py:421] 2025-12-21 07:58:55,881 >> Offline mode: forcing local_files_only=True
[INFO|hub.py:421] 2025-12-21 07:58:55,881 >> Offline mode: forcing local_files_only=True
[INFO|image_processing_base.py:316] 2025-12-21 07:58:55,882 >> Offline mode: forcing local_files_only=True
[INFO|image_processing_base.py:383] 2025-12-21 07:58:55,884 >> loading configuration file preprocessor_config.json from cache at /scratch/indrisch/huggingface/hub/models--Video-R1--Video-R1-7B/snapshots/e6840e4cdc86b484b05aacdcb5c88ad3d7ef3d76/preprocessor_config.json
[INFO|image_processing_base.py:316] 2025-12-21 07:58:55,887 >> Offline mode: forcing local_files_only=True
[INFO|image_processing_base.py:383] 2025-12-21 07:58:55,888 >> loading configuration file preprocessor_config.json from cache at /scratch/indrisch/huggingface/hub/models--Video-R1--Video-R1-7B/snapshots/e6840e4cdc86b484b05aacdcb5c88ad3d7ef3d76/preprocessor_config.json
[INFO|image_processing_base.py:428] 2025-12-21 07:58:55,895 >> Image processor Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "disable_grouping": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 401408,
  "merge_size": 2,
  "min_pixels": 3136,
  "pad_size": null,
  "patch_size": 14,
  "processor_class": "Qwen2_5_VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 401408,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

[INFO|tokenization_utils_base.py:1949] 2025-12-21 07:58:55,895 >> Offline mode: forcing local_files_only=True
[INFO|tokenization_utils_base.py:2095] 2025-12-21 07:58:55,896 >> loading file vocab.json from cache at /scratch/indrisch/huggingface/hub/models--Video-R1--Video-R1-7B/snapshots/e6840e4cdc86b484b05aacdcb5c88ad3d7ef3d76/vocab.json
[INFO|tokenization_utils_base.py:2095] 2025-12-21 07:58:55,896 >> loading file merges.txt from cache at /scratch/indrisch/huggingface/hub/models--Video-R1--Video-R1-7B/snapshots/e6840e4cdc86b484b05aacdcb5c88ad3d7ef3d76/merges.txt
[INFO|tokenization_utils_base.py:2095] 2025-12-21 07:58:55,896 >> loading file tokenizer.json from cache at /scratch/indrisch/huggingface/hub/models--Video-R1--Video-R1-7B/snapshots/e6840e4cdc86b484b05aacdcb5c88ad3d7ef3d76/tokenizer.json
[INFO|tokenization_utils_base.py:2095] 2025-12-21 07:58:55,896 >> loading file added_tokens.json from cache at /scratch/indrisch/huggingface/hub/models--Video-R1--Video-R1-7B/snapshots/e6840e4cdc86b484b05aacdcb5c88ad3d7ef3d76/added_tokens.json
[INFO|tokenization_utils_base.py:2095] 2025-12-21 07:58:55,896 >> loading file special_tokens_map.json from cache at /scratch/indrisch/huggingface/hub/models--Video-R1--Video-R1-7B/snapshots/e6840e4cdc86b484b05aacdcb5c88ad3d7ef3d76/special_tokens_map.json
[INFO|tokenization_utils_base.py:2095] 2025-12-21 07:58:55,896 >> loading file tokenizer_config.json from cache at /scratch/indrisch/huggingface/hub/models--Video-R1--Video-R1-7B/snapshots/e6840e4cdc86b484b05aacdcb5c88ad3d7ef3d76/tokenizer_config.json
[INFO|tokenization_utils_base.py:2095] 2025-12-21 07:58:55,896 >> loading file chat_template.jinja from cache at None
[INFO|tokenization_utils_base.py:2364] 2025-12-21 07:58:56,179 >> Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
[INFO|video_processing_utils.py:660] 2025-12-21 07:58:56,180 >> Offline mode: forcing local_files_only=True
[INFO|video_processing_utils.py:726] 2025-12-21 07:58:56,182 >> loading configuration file video_preprocessor_config.json from cache at /scratch/indrisch/huggingface/hub/models--Video-R1--Video-R1-7B/snapshots/e6840e4cdc86b484b05aacdcb5c88ad3d7ef3d76/preprocessor_config.json
[INFO|video_processing_utils.py:770] 2025-12-21 07:58:56,186 >> Video processor Qwen2VLVideoProcessor {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "do_sample_frames": false,
  "fps": null,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_frames": 768,
  "max_pixels": 401408,
  "merge_size": 2,
  "min_frames": 4,
  "min_pixels": 3136,
  "num_frames": null,
  "pad_size": null,
  "patch_size": 14,
  "processor_class": "Qwen2_5_VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_metadata": false,
  "size": {
    "longest_edge": 401408,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2,
  "video_metadata": null,
  "video_processor_type": "Qwen2VLVideoProcessor"
}

[INFO|processing_utils.py:928] 2025-12-21 07:58:56,186 >> Offline mode: forcing local_files_only=True
[INFO|processing_utils.py:1116] 2025-12-21 07:58:56,189 >> loading configuration file processor_config.json from cache at None
[INFO|processing_utils.py:1199] 2025-12-21 07:58:56,527 >> Processor Qwen2_5_VLProcessor:
- image_processor: Qwen2VLImageProcessorFast {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "disable_grouping": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_pad": null,
  "do_rescale": true,
  "do_resize": true,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_processor_type": "Qwen2VLImageProcessorFast",
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_pixels": 401408,
  "merge_size": 2,
  "min_pixels": 3136,
  "pad_size": null,
  "patch_size": 14,
  "processor_class": "Qwen2_5_VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_tensors": null,
  "size": {
    "longest_edge": 401408,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2
}

- tokenizer: Qwen2TokenizerFast(name_or_path='Video-R1/Video-R1-7B', vocab_size=151643, model_max_length=131072, is_fast=True, padding_side='right', truncation_side='right', special_tokens={'eos_token': '<|im_end|>', 'pad_token': '<|endoftext|>', 'additional_special_tokens': ['<|im_start|>', '<|im_end|>', '<|object_ref_start|>', '<|object_ref_end|>', '<|box_start|>', '<|box_end|>', '<|quad_start|>', '<|quad_end|>', '<|vision_start|>', '<|vision_end|>', '<|vision_pad|>', '<|image_pad|>', '<|video_pad|>']}, clean_up_tokenization_spaces=False, added_tokens_decoder={
	151643: AddedToken("<|endoftext|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151644: AddedToken("<|im_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151645: AddedToken("<|im_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151646: AddedToken("<|object_ref_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151647: AddedToken("<|object_ref_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151648: AddedToken("<|box_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151649: AddedToken("<|box_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151650: AddedToken("<|quad_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151651: AddedToken("<|quad_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151652: AddedToken("<|vision_start|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151653: AddedToken("<|vision_end|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151654: AddedToken("<|vision_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151655: AddedToken("<|image_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151656: AddedToken("<|video_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	151657: AddedToken("<tool_call>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=False),
	151658: AddedToken("</tool_call>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=False),
	151659: AddedToken("<|fim_prefix|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=False),
	151660: AddedToken("<|fim_middle|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=False),
	151661: AddedToken("<|fim_suffix|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=False),
	151662: AddedToken("<|fim_pad|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=False),
	151663: AddedToken("<|repo_name|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=False),
	151664: AddedToken("<|file_sep|>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=False),
}
)
- video_processor: Qwen2VLVideoProcessor {
  "crop_size": null,
  "data_format": "channels_first",
  "default_to_square": true,
  "device": null,
  "do_center_crop": null,
  "do_convert_rgb": true,
  "do_normalize": true,
  "do_rescale": true,
  "do_resize": true,
  "do_sample_frames": false,
  "fps": null,
  "image_mean": [
    0.48145466,
    0.4578275,
    0.40821073
  ],
  "image_std": [
    0.26862954,
    0.26130258,
    0.27577711
  ],
  "input_data_format": null,
  "max_frames": 768,
  "max_pixels": 401408,
  "merge_size": 2,
  "min_frames": 4,
  "min_pixels": 3136,
  "num_frames": null,
  "pad_size": null,
  "patch_size": 14,
  "processor_class": "Qwen2_5_VLProcessor",
  "resample": 3,
  "rescale_factor": 0.00392156862745098,
  "return_metadata": false,
  "size": {
    "longest_edge": 401408,
    "shortest_edge": 3136
  },
  "temporal_patch_size": 2,
  "video_metadata": null,
  "video_processor_type": "Qwen2VLVideoProcessor"
}


{
  "processor_class": "Qwen2_5_VLProcessor"
}

[DEBUG get_template_and_fix_tokenizer] Requested template: videor1
[DEBUG get_template_and_fix_tokenizer] Available templates: ['alpaca', 'aquila', 'atom', 'baichuan', 'baichuan2', 'bailing', 'bailing_v2', 'belle', 'bluelm', 'breeze', 'chatglm2', 'chatglm3', 'chatml', 'chatml_de', 'codegeex2', 'codegeex4', 'cohere', 'cpm', 'cpm3', 'cpm4']...
[DEBUG get_template_and_fix_tokenizer] Total templates registered: 120
[DEBUG get_template_and_fix_tokenizer] videor1 in TEMPLATES: True
[INFO|2025-12-21 07:58:56] llamafactory.data.loader:143 >> Loading dataset /scratch/indrisch/huggingface/hub/datasets--cvis-tmu--llamafactory-sqa3d-traces-multiimage-vqa/snapshots/ce5c54adc1608d1726730c9ff334e65b6dd70e46/data/...
`trust_remote_code` is not supported anymore.
Please check that the Hugging Face dataset 'parquet' isn't based on a loading script and remove `trust_remote_code`.
If the dataset is based on a loading script, please ask the dataset author to remove it and convert it to a standard format like Parquet.
[INFO|2025-12-21 07:58:57] llamafactory.hparams.parser:455 >> Process rank: 3, world size: 4, device: cuda:3, distributed training: True, compute dtype: torch.bfloat16
[INFO|2025-12-21 07:58:57] llamafactory.hparams.parser:455 >> Process rank: 1, world size: 4, device: cuda:1, distributed training: True, compute dtype: torch.bfloat16
[INFO|2025-12-21 07:58:57] llamafactory.hparams.parser:455 >> Process rank: 2, world size: 4, device: cuda:2, distributed training: True, compute dtype: torch.bfloat16
[DEBUG get_template_and_fix_tokenizer] Requested template: videor1
[DEBUG get_template_and_fix_tokenizer] Available templates: ['alpaca', 'aquila', 'atom', 'baichuan', 'baichuan2', 'bailing', 'bailing_v2', 'belle', 'bluelm', 'breeze', 'chatglm2', 'chatglm3', 'chatml', 'chatml_de', 'codegeex2', 'codegeex4', 'cohere', 'cpm', 'cpm3', 'cpm4']...
[DEBUG get_template_and_fix_tokenizer] Total templates registered: 120
[DEBUG get_template_and_fix_tokenizer] videor1 in TEMPLATES: True
[rank2]:[W1221 07:58:58.418443288 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 2]  using GPU 2 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[DEBUG get_template_and_fix_tokenizer] Requested template: videor1
[DEBUG get_template_and_fix_tokenizer] Available templates: ['alpaca', 'aquila', 'atom', 'baichuan', 'baichuan2', 'bailing', 'bailing_v2', 'belle', 'bluelm', 'breeze', 'chatglm2', 'chatglm3', 'chatml', 'chatml_de', 'codegeex2', 'codegeex4', 'cohere', 'cpm', 'cpm3', 'cpm4']...
[DEBUG get_template_and_fix_tokenizer] Total templates registered: 120
[DEBUG get_template_and_fix_tokenizer] videor1 in TEMPLATES: True
[DEBUG get_template_and_fix_tokenizer] Requested template: videor1
[DEBUG get_template_and_fix_tokenizer] Available templates: ['alpaca', 'aquila', 'atom', 'baichuan', 'baichuan2', 'bailing', 'bailing_v2', 'belle', 'bluelm', 'breeze', 'chatglm2', 'chatglm3', 'chatml', 'chatml_de', 'codegeex2', 'codegeex4', 'cohere', 'cpm', 'cpm3', 'cpm4']...
[DEBUG get_template_and_fix_tokenizer] Total templates registered: 120
[DEBUG get_template_and_fix_tokenizer] videor1 in TEMPLATES: True
[rank1]:[W1221 07:58:58.476697524 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 1]  using GPU 1 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[rank3]:[W1221 07:58:58.478005158 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 3]  using GPU 3 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
Converting format of dataset (num_proc=16):  44%|████▎     | 14458/33047 [00:00<?, ? examples/s]Converting format of dataset (num_proc=16):  44%|████▍     | 14459/33047 [00:07<37:44:03,  7.31s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14460/33047 [00:10<25:38:25,  4.97s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14461/33047 [00:15<25:15:31,  4.89s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14462/33047 [00:17<20:22:38,  3.95s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14463/33047 [00:20<17:55:30,  3.47s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14464/33047 [00:34<36:27:19,  7.06s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14465/33047 [00:36<27:39:55,  5.36s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14466/33047 [01:03<63:18:43, 12.27s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14467/33047 [01:13<60:03:59, 11.64s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14468/33047 [01:27<63:43:07, 12.35s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14469/33047 [01:31<50:44:54,  9.83s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14470/33047 [01:36<42:41:59,  8.27s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14471/33047 [01:37<30:34:35,  5.93s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14472/33047 [01:37<22:12:46,  4.31s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14473/33047 [01:39<17:40:34,  3.43s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14474/33047 [02:41<110:01:09, 21.33s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14475/33047 [02:42<77:16:09, 14.98s/ examples] Converting format of dataset (num_proc=16):  44%|████▍     | 14476/33047 [02:44<57:07:56, 11.08s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14477/33047 [02:44<40:59:42,  7.95s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14478/33047 [02:45<29:20:30,  5.69s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14479/33047 [02:46<21:57:00,  4.26s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14480/33047 [02:46<15:47:42,  3.06s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14481/33047 [02:46<11:58:17,  2.32s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14482/33047 [02:47<9:54:33,  1.92s/ examples] Converting format of dataset (num_proc=16):  44%|████▍     | 14483/33047 [02:48<8:29:06,  1.65s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14484/33047 [02:53<12:24:31,  2.41s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14485/33047 [02:54<10:10:25,  1.97s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14486/33047 [02:55<8:48:52,  1.71s/ examples] Converting format of dataset (num_proc=16):  44%|████▍     | 14487/33047 [02:56<7:31:32,  1.46s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14488/33047 [02:57<7:09:05,  1.39s/ examples][WARNING|2025-12-21 08:06:13] llamafactory.data.converter:154 >> Media ScanNet/scans/scene0046_00/color/504.jpg does not exist in `media_dir`. Use original path.
Converting format of dataset (num_proc=16):  44%|████▍     | 14490/33047 [02:57<4:34:02,  1.13 examples/s]Converting format of dataset (num_proc=16):  44%|████▍     | 14491/33047 [02:59<4:59:17,  1.03 examples/s]Converting format of dataset (num_proc=16):  44%|████▍     | 14492/33047 [02:59<4:26:30,  1.16 examples/s][WARNING|2025-12-21 08:06:16] llamafactory.data.converter:154 >> Media ScanNet/scans/scene0046_00/color/2160.jpg does not exist in `media_dir`. Use original path.
Converting format of dataset (num_proc=16):  44%|████▍     | 14493/33047 [03:00<4:14:53,  1.21 examples/s]Converting format of dataset (num_proc=16):  44%|████▍     | 14495/33047 [03:01<3:56:54,  1.31 examples/s]Converting format of dataset (num_proc=16):  44%|████▍     | 14496/33047 [03:02<4:09:04,  1.24 examples/s]Converting format of dataset (num_proc=16):  44%|████▍     | 14497/33047 [03:03<4:17:02,  1.20 examples/s]Converting format of dataset (num_proc=16):  44%|████▍     | 14498/33047 [03:05<5:31:39,  1.07s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14499/33047 [03:34<44:54:41,  8.72s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14500/33047 [03:35<33:38:19,  6.53s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14501/33047 [03:35<24:47:00,  4.81s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14502/33047 [03:35<17:48:49,  3.46s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14504/33047 [03:36<10:01:39,  1.95s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14505/33047 [03:36<7:48:49,  1.52s/ examples] Converting format of dataset (num_proc=16):  44%|████▍     | 14506/33047 [03:37<6:57:23,  1.35s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14507/33047 [03:38<7:25:43,  1.44s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14508/33047 [03:39<6:07:58,  1.19s/ examples]Converting format of dataset (num_proc=16):  44%|████▍     | 14509/33047 [03:39<5:05:47,  1.01 examples/s]Converting format of dataset (num_proc=16):  44%|████▍     | 14510/33047 [03:40<3:51:26,  1.33 examples/s]Converting format of dataset (num_proc=16):  44%|████▍     | 14511/33047 [03:40<3:41:56,  1.39 examples/s]Converting format of dataset (num_proc=16):  44%|████▍     | 14512/33047 [03:41<3:05:20,  1.67 examples/s]slurmstepd: error: *** JOB 4499803 ON rg31601 CANCELLED AT 2025-12-21T08:06:59 ***
