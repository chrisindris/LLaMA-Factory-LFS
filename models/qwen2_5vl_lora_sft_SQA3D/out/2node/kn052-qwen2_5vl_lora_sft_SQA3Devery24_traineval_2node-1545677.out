created virtual environment CPython3.11.5.final.0-64 in 285ms
  creator CPython3Posix(dest=/tmp/ENV, clear=False, no_vcs_ignore=False, global=False)
  seeder FromAppData(download=False, pip=bundle, setuptools=bundle, wheel=bundle, via=copy, app_data_dir=/home/indrisch/.local/share/virtualenv)
    added seed packages: pip==25.3, setuptools==80.7.1, wheel==0.45.1+computecanada
  activators BashActivator,CShellActivator,FishActivator,NushellActivator,PowerShellActivator,PythonActivator
created virtual environment CPython3.11.5.final.0-64 in 259ms
  creator CPython3Posix(dest=/tmp/ENV, clear=False, no_vcs_ignore=False, global=False)
  seeder FromAppData(download=False, pip=bundle, setuptools=bundle, wheel=bundle, via=copy, app_data_dir=/home/indrisch/.local/share/virtualenv)
    added seed packages: pip==25.3, setuptools==80.7.1, wheel==0.45.1+computecanada
  activators BashActivator,CShellActivator,FishActivator,NushellActivator,PowerShellActivator,PythonActivator
Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Requirement already satisfied: pip in /tmp/ENV/lib/python3.11/site-packages (25.3)
Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Requirement already satisfied: pip in /tmp/ENV/lib/python3.11/site-packages (25.3)
Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Looking in links: /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic, /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/ray-2.49.1+computecanada-cp311-cp311-linux_x86_64.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/ray-2.49.1+computecanada-cp311-cp311-linux_x86_64.whl
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/click-8.3.1+computecanada-py3-none-any.whl (from ray)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/filelock-3.20.0+computecanada-py3-none-any.whl (from ray)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/jsonschema-4.25.1+computecanada-py3-none-any.whl (from ray)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/msgpack-1.1.2+computecanada-cp311-cp311-linux_x86_64.whl (from ray)
Requirement already satisfied: packaging in /cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/scipy-stack/2025a/lib/python3.11/site-packages (from ray) (24.2+computecanada)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/click-8.3.1+computecanada-py3-none-any.whl (from ray)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3/protobuf-6.33.0+computecanada-cp311-cp311-linux_x86_64.whl (from ray)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/filelock-3.20.0+computecanada-py3-none-any.whl (from ray)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3/PyYAML-6.0.2+computecanada-cp311-cp311-linux_x86_64.whl (from ray)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/jsonschema-4.25.1+computecanada-py3-none-any.whl (from ray)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/requests-2.32.5+computecanada-py3-none-any.whl (from ray)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/msgpack-1.1.2+computecanada-cp311-cp311-linux_x86_64.whl (from ray)
Requirement already satisfied: packaging in /cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/scipy-stack/2025a/lib/python3.11/site-packages (from ray) (24.2+computecanada)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/attrs-25.4.0+computecanada-py3-none-any.whl (from jsonschema->ray)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/jsonschema_specifications-2025.9.1+computecanada-py3-none-any.whl (from jsonschema->ray)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3/protobuf-6.33.0+computecanada-cp311-cp311-linux_x86_64.whl (from ray)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/referencing-0.37.0+computecanada-py3-none-any.whl (from jsonschema->ray)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/x86-64-v3/PyYAML-6.0.2+computecanada-cp311-cp311-linux_x86_64.whl (from ray)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic/rpds_py-0.27.0+computecanada-cp311-cp311-linux_x86_64.whl (from jsonschema->ray)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/requests-2.32.5+computecanada-py3-none-any.whl (from ray)
Requirement already satisfied: typing-extensions>=4.4.0 in /cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/ipykernel/2025a/lib/python3.11/site-packages (from referencing>=0.28.4->jsonschema->ray) (4.12.2+computecanada)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/attrs-25.4.0+computecanada-py3-none-any.whl (from jsonschema->ray)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/charset_normalizer-3.4.4+computecanada-py3-none-any.whl (from requests->ray)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/jsonschema_specifications-2025.9.1+computecanada-py3-none-any.whl (from jsonschema->ray)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/idna-3.11+computecanada-py3-none-any.whl (from requests->ray)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/referencing-0.37.0+computecanada-py3-none-any.whl (from jsonschema->ray)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/gentoo2023/generic/rpds_py-0.27.0+computecanada-cp311-cp311-linux_x86_64.whl (from jsonschema->ray)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/urllib3-2.5.0+computecanada-py3-none-any.whl (from requests->ray)
Requirement already satisfied: typing-extensions>=4.4.0 in /cvmfs/soft.computecanada.ca/easybuild/software/2023/x86-64-v3/Compiler/gcccore/ipykernel/2025a/lib/python3.11/site-packages (from referencing>=0.28.4->jsonschema->ray) (4.12.2+computecanada)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/certifi-2025.10.5+computecanada-py3-none-any.whl (from requests->ray)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/charset_normalizer-3.4.4+computecanada-py3-none-any.whl (from requests->ray)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/idna-3.11+computecanada-py3-none-any.whl (from requests->ray)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/urllib3-2.5.0+computecanada-py3-none-any.whl (from requests->ray)
Processing /cvmfs/soft.computecanada.ca/custom/python/wheelhouse/generic/certifi-2025.10.5+computecanada-py3-none-any.whl (from requests->ray)
Installing collected packages: urllib3, rpds-py, pyyaml, protobuf, msgpack, idna, filelock, click, charset-normalizer, certifi, attrs, requests, referencing, jsonschema-specifications, jsonschema, ray
Installing collected packages: urllib3, rpds-py, pyyaml, protobuf, msgpack, idna, filelock, click, charset-normalizer, certifi, attrs, requests, referencing, jsonschema-specifications, jsonschema, ray

Successfully installed attrs-25.4.0+computecanada certifi-2025.10.5+computecanada charset-normalizer-3.4.4+computecanada click-8.3.1+computecanada filelock-3.20.0+computecanada idna-3.11+computecanada jsonschema-4.25.1+computecanada jsonschema-specifications-2025.9.1+computecanada msgpack-1.1.2+computecanada protobuf-6.33.0+computecanada pyyaml-6.0.2+computecanada ray-2.49.1+computecanada referencing-0.37.0+computecanada requests-2.32.5+computecanada rpds-py-0.27.0+computecanada urllib3-2.5.0+computecanada

Successfully installed attrs-25.4.0+computecanada certifi-2025.10.5+computecanada charset-normalizer-3.4.4+computecanada click-8.3.1+computecanada filelock-3.20.0+computecanada idna-3.11+computecanada jsonschema-4.25.1+computecanada jsonschema-specifications-2025.9.1+computecanada msgpack-1.1.2+computecanada protobuf-6.33.0+computecanada pyyaml-6.0.2+computecanada ray-2.49.1+computecanada referencing-0.37.0+computecanada requests-2.32.5+computecanada rpds-py-0.27.0+computecanada urllib3-2.5.0+computecanada
Waiting for Ray cluster to initialize...
2025-12-04 18:12:14,793	INFO usage_lib.py:473 -- Usage stats collection is enabled by default without user confirmation because this terminal is detected to be non-interactive. To disable this, add `--disable-usage-stats` to the command that starts the cluster, or run the following command: `ray disable-usage-stats` before starting the cluster. See https://docs.ray.io/en/master/cluster/usage-stats.html for more details.
2025-12-04 18:12:14,793	INFO scripts.py:913 -- Local node IP: kn052
2025-12-04 18:12:16,048	SUCC scripts.py:949 -- --------------------
2025-12-04 18:12:16,048	SUCC scripts.py:950 -- Ray runtime started.
2025-12-04 18:12:16,048	SUCC scripts.py:951 -- --------------------
2025-12-04 18:12:16,048	INFO scripts.py:953 -- Next steps
2025-12-04 18:12:16,048	INFO scripts.py:956 -- To add another node to this Ray cluster, run
2025-12-04 18:12:16,048	INFO scripts.py:959 --   ray start --address='kn052:33351'
2025-12-04 18:12:16,048	INFO scripts.py:968 -- To connect to this Ray cluster:
2025-12-04 18:12:16,048	INFO scripts.py:970 -- import ray
2025-12-04 18:12:16,048	INFO scripts.py:971 -- ray.init(_node_ip_address='kn052')
2025-12-04 18:12:16,048	INFO scripts.py:1002 -- To terminate the Ray runtime, run
2025-12-04 18:12:16,048	INFO scripts.py:1003 --   ray stop
2025-12-04 18:12:16,048	INFO scripts.py:1006 -- To view the status of the cluster, use
2025-12-04 18:12:16,048	INFO scripts.py:1007 --   ray status
2025-12-04 18:12:16,048	INFO scripts.py:1123 -- --block
2025-12-04 18:12:16,048	INFO scripts.py:1124 -- This command will now block forever until terminated by a signal.
2025-12-04 18:12:16,048	INFO scripts.py:1127 -- Running subprocesses are monitored and a message will be printed if any of them terminate unexpectedly. Subprocesses exit with SIGTERM will be treated as graceful, thus NOT reported.
2025-12-04 18:12:14,791	INFO scripts.py:1094 -- Local node IP: 10.1.1.53
2025-12-04 18:12:17,213	SUCC scripts.py:1110 -- --------------------
2025-12-04 18:12:17,213	SUCC scripts.py:1111 -- Ray runtime started.
2025-12-04 18:12:17,214	SUCC scripts.py:1112 -- --------------------
2025-12-04 18:12:17,214	INFO scripts.py:1114 -- To terminate the Ray runtime, run
2025-12-04 18:12:17,214	INFO scripts.py:1115 --   ray stop
2025-12-04 18:12:17,215	INFO scripts.py:1123 -- --block
2025-12-04 18:12:17,215	INFO scripts.py:1124 -- This command will now block forever until terminated by a signal.
2025-12-04 18:12:17,215	INFO scripts.py:1127 -- Running subprocesses are monitored and a message will be printed if any of them terminate unexpectedly. Subprocesses exit with SIGTERM will be treated as graceful, thus NOT reported.
2025-12-04 18:12:19,520	INFO worker.py:1771 -- Connecting to existing Ray cluster at address: kn052:33351...
2025-12-04 18:12:19,534	INFO worker.py:1951 -- Connected to Ray cluster.
Ray cluster connected successfully
Available resources: {'GPU': 2.0, 'memory': 619040527975.0, 'node:10.1.1.53': 1.0, 'object_store_memory': 265303083417.0, 'CPU': 2.0, 'accelerator_type:L40S': 2.0, 'node:__internal_head__': 1.0, 'node:kn052': 1.0}
Ray verification complete
Ray cluster verification complete. Starting training...
2025-12-04 18:12:21,249	INFO worker.py:1771 -- Connecting to existing Ray cluster at address: kn052:33351...
2025-12-04 18:12:21,263	INFO worker.py:1951 -- Connected to Ray cluster.
Nodes in the Ray cluster:
[{'NodeID': '25dfaed617cbf2343678eef9cd4d09f129bc9169d00c1d7a422b26eb', 'Alive': True, 'NodeManagerAddress': '10.1.1.53', 'NodeManagerHostname': 'kn053', 'NodeManagerPort': 43935, 'ObjectManagerPort': 39151, 'ObjectStoreSocketName': '/tmp/ray/session_2025-12-04_18-12-14_793758_817461/sockets/plasma_store', 'RayletSocketName': '/tmp/ray/session_2025-12-04_18-12-14_793758_817461/sockets/raylet', 'MetricsExportPort': 44104, 'NodeName': '10.1.1.53', 'RuntimeEnvAgentPort': 56210, 'DeathReason': 0, 'DeathReasonMessage': '', 'alive': True, 'Resources': {'memory': 310036494746.0, 'object_store_memory': 132872783462.0, 'GPU': 1.0, 'accelerator_type:L40S': 1.0, 'CPU': 1.0, 'node:10.1.1.53': 1.0}, 'Labels': {'ray.io/accelerator-type': 'L40S', 'ray.io/node-id': '25dfaed617cbf2343678eef9cd4d09f129bc9169d00c1d7a422b26eb'}}, {'NodeID': '725836c1df0e14264ff7cacac45f26a61881bdbd8b9e14dba74d6632', 'Alive': True, 'NodeManagerAddress': 'kn052', 'NodeManagerHostname': 'kn052', 'NodeManagerPort': 37421, 'ObjectManagerPort': 33499, 'ObjectStoreSocketName': '/tmp/ray/session_2025-12-04_18-12-14_793758_817461/sockets/plasma_store', 'RayletSocketName': '/tmp/ray/session_2025-12-04_18-12-14_793758_817461/sockets/raylet', 'MetricsExportPort': 53815, 'NodeName': 'kn052', 'RuntimeEnvAgentPort': 59670, 'DeathReason': 0, 'DeathReasonMessage': '', 'alive': True, 'Resources': {'node:kn052': 1.0, 'memory': 309004033229.0, 'node:__internal_head__': 1.0, 'object_store_memory': 132430299955.0, 'GPU': 1.0, 'accelerator_type:L40S': 1.0, 'CPU': 1.0}, 'Labels': {'ray.io/accelerator-type': 'L40S', 'ray.io/node-id': '725836c1df0e14264ff7cacac45f26a61881bdbd8b9e14dba74d6632'}}]
{'object_store_memory': 265303083417.0, 'memory': 619040527975.0, 'CPU': 2.0, 'node:10.1.1.53': 1.0, 'accelerator_type:L40S': 2.0, 'GPU': 2.0, 'node:__internal_head__': 1.0, 'node:kn052': 1.0}
srun: forcing job termination
srun: Job step aborted: Waiting up to 62 seconds for job step to finish.
slurmstepd: error: *** STEP 1545677.1 ON kn052 CANCELLED AT 2025-12-04T18:12:22 ***
srun: error: kn053: task 1: Killed
srun: error: kn052: task 0: Killed
